function LogicHop(a){this.data=a}if(LogicHop.prototype.dump=function(){console.log(this.data)},LogicHop.prototype.parseLogic=function(){var a=this;if(a.data.send=!!a.data.js_track,a.data.conditions=[],a.data.conditions_json=[],a.data.variables=[],a.data.referrer="referrer"in document?document.referrer:"",jQuery(".logichop-js").each(function(){var e=jQuery(this).attr("data-cid"),o=jQuery(this).attr("data-condition"),t=jQuery(this).attr("data-var");e&&(a.data.send=!0,-1==jQuery.inArray(e,a.data.conditions)&&a.data.conditions.push(e)),o&&(a.data.send=!0,-1==jQuery.inArray(o,a.data.conditions_json)&&a.data.conditions_json.push(o)),t&&a.data.js_vars&&(a.data.send=!0,-1==jQuery.inArray(t,a.data.variables)&&a.data.variables.push(t))}),a.data.send){var e=a.getQueryStrings();e.action="logichop_parse_logic",e.uncache=(new Date).valueOf(),e.data=a.data,jQuery.ajax({type:"POST",dataType:"json",url:a.data.ajaxurl,data:e,cache:!1,success:function(e){e.success&&(a.checkPageGoals(),e.redirect&&(window.location=e.redirect),e.conditions.length>0&&a.displayConditions(e.conditions),e.conditions_json.length>0&&a.displayConditionsJson(e.conditions_json),e.variables.length>0&&a.displayVariables(e.variables),void 0!==e.header_css&&""!=e.header_css&&jQuery("#logichop_header_css").append(e.header_css),void 0!==e.css&&""!=e.css&&jQuery("body").addClass(e.css),void 0!==e.css_preview&&(a.data.css_preview=e.css_preview),a.pageRendered())}})}},LogicHop.prototype.displayConditions=function(a){for(var e=0;e<a.length;e++)jQuery('.logichop-js[data-cid="'+a[e].cid+'"]').each(function(){var o=jQuery(this),t=o.attr("data-not"),d=a[e].condition;if("true"===t&&(d=!d),d){var r=o.attr("data-event")?o.attr("data-event").toLowerCase():"";if(o.addClass(o.attr("data-css-add")).removeClass(o.attr("data-css-remove")),"hide"==r&&o.hide(),"show"==r&&o.show(),"toggle"==r&&o.toggle(),"slideup"==r&&o.slideUp(),"slidedown"==r&&o.slideDown(),"slidetoggle"==r&&o.slideToggle(),"fadein"==r&&o.fadeIn(),"fadeout"==r&&o.fadeOut(),"fadetoggle"==r&&o.fadeToggle(),"callback"==r){var i=window[o.attr("data-callback")];if("function"==typeof i){var s=[o];i.apply(null,s)}}}})},LogicHop.prototype.displayConditionsJson=function(a){for(var e=0;e<a.length;e++)jQuery('.logichop-js[data-hash="'+a[e].hash+'"]').each(function(){var a=jQuery(this),e=a.attr("data-event")?a.attr("data-event").toLowerCase():"";e||a.show(),"show"==e&&a.show(),"hide"==e&&a.hide(),"toggle"==e&&a.toggle(),"slideup"==e&&a.slideUp(),"slidedown"==e&&a.slideDown(),"slidetoggle"==e&&a.slideToggle(),"fadein"==e&&a.fadeIn(),"fadeout"==e&&a.fadeOut(),"fadetoggle"==e&&a.fadeToggle()})},LogicHop.prototype.displayVariables=function(a){for(var e=0;e<a.length;e++)a[e].data_var&&void 0!==a[e].value&&jQuery('.logichop-js[data-var="'+a[e].data_var+'"]').each(function(){var o=jQuery(this),t=o.attr("data-type")?o.attr("data-type").toLowerCase():"replace",d=o.attr("data-event")?o.attr("data-event").toLowerCase():"",r=!!o.attr("data-case")&&o.attr("data-case").toLowerCase(),i=!!o.attr("data-spaces")&&o.attr("data-spaces").toLowerCase(),s=!!o.attr("data-prepend")&&o.attr("data-prepend"),n=!!o.attr("data-append")&&o.attr("data-append");if(null!=a[e].value){var c=a[e].value;if(r&&c&&(c=c.textf(r)),i&&(c=c.replace(/ /g,i)),"replace"!=t&&"html"!=t||o.html(c).addClass(o.attr("data-css-add")).removeClass(o.attr("data-css-remove")),"append"==t&&o.append(c).addClass(o.attr("data-css-add")).removeClass(o.attr("data-css-remove")),"prepend"==t&&o.prepend(c).addClass(o.attr("data-css-add")).removeClass(o.attr("data-css-remove")),"text"==t&&o.text(c).addClass(o.attr("data-css-add")).removeClass(o.attr("data-css-remove")),"value"==t&&o.val(c).addClass(o.attr("data-css-add")).removeClass(o.attr("data-css-remove")),"class"==t){var l=o.attr("data-class");if(l){var p=l.replace(/#VAR#/,c);o.addClass(p).addClass(o.attr("data-css-add")).removeClass(o.attr("data-css-remove"))}}if("source"==t){var u=o.attr("data-src");if(u){var g=u.replace(/#VAR#/,c);o.attr("src",g)}}s&&o.prepend(s),n&&o.append(n),"hide"==d&&o.hide(),"show"==d&&o.show(),"toggle"==d&&o.toggle(),"slideup"==d&&o.slideUp(),"slidedown"==d&&o.slideDown(),"slidetoggle"==d&&o.slideToggle(),"fadein"==d&&o.fadeIn(),"fadeout"==d&&o.fadeOut(),"fadetoggle"==d&&o.fadeToggle()}})},LogicHop.prototype.checkPageGoals=function(){var a=this;jQuery(".logichop-goal").each(function(){var e=jQuery(this).val(),o=!!jQuery(this).attr("data-condition")&&jQuery(this).attr("data-condition"),t=!!jQuery(this).attr("data-not"),d=!!jQuery(this).attr("data-delete");e&&a.updateGoal(e,o,t,d)})},LogicHop.prototype.enablePageGoals=function(){var a=this;function e(e){var o=jQuery(e.target).data("goal");o&&a.updateGoal(o)}jQuery(".logichop-click").on("click",e),jQuery(".logichop-dblclick").on("dblclick",e),jQuery(".logichop-mouseenter").on("mouseenter",e),jQuery(".logichop-mouseleave").on("mouseleave",e),jQuery(".logichop-keypress").on("keypress",e),jQuery(".logichop-keydown").on("keydown",e),jQuery(".logichop-keyup").on("keyup",e),jQuery(".logichop-submit").on("submit",e),jQuery(".logichop-change").on("change",e),jQuery(".logichop-focus").on("focus",e),jQuery(".logichop-blur").on("blur",e),jQuery(".logichop-load").on("load",e),jQuery(".logichop-resize").on("resize",e),jQuery(".logichop-scroll").on("scroll",e),jQuery(".logichop-unload").on("unload",e),void 0!==a.data.goal_ev&&void 0!==a.data.goal_el&&void 0!==a.data.goal_js&&jQuery(a.data.goal_el).on(a.data.goal_ev,function(){a.updateGoal(a.data.goal_js)})},LogicHop.prototype.updateGoal=function(a,e,o,t){e=void 0!==e&&e,o=void 0!==o&&o,t=void 0!==t&&t;var d={action:"logichop_goal",goal:a,uncache:(new Date).valueOf()};e&&(d.condition=e),o&&(d.condition_not=!0),t&&(d.delete_goal=!0),jQuery.ajax({type:"POST",dataType:"json",url:this.data.ajaxurl,data:d,cache:!1,success:function(a){return!0}})},LogicHop.prototype.getQueryStrings=function(){for(var a,e=/\+/g,o=/([^&=]+)=?([^&]*)/g,t=function(a){return decodeURIComponent(a.replace(e," "))},d=window.location.search.substring(1),r={};a=o.exec(d);)r[t(a[1])]=t(a[2]);return r},LogicHop.prototype.pageRendered=function(){jQuery(".logichop-fade-in").fadeTo("fast",1),jQuery(".logichop-slide-down").slideDown()},void 0!==logichop.pid){var logichop=new LogicHop(logichop);jQuery(document).ready(function(){logichop.parseLogic(),logichop.enablePageGoals()})}function logichop_goal(a,e,o){e=void 0!==e&&e,o=void 0!==o&&o,void 0!==logichop&&logichop.updateGoal(a,e,o)}function logichop_goal_delete(a,e,o){e=void 0!==e&&e,o=void 0!==o&&o,void 0!==logichop&&logichop.updateGoal(a,e,o,!0)}String.prototype.textf=function(a){return"lower"==a?this.toLowerCase():"upper"==a?this.toUpperCase():"words"==a?this.ucwords():"first"==a?this.capitalize():this},String.prototype.ucwords=function(){return this.toLowerCase().replace(/\b[a-z]/g,function(a){return a.toUpperCase()})},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};
